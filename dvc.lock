schema: '2.0'
stages:
  data_split:
    cmd: python stages/data_split.py --config=params.yaml
    deps:
    - path: data/Churn_Modelling.csv
      md5: 73fba4fd85b6dbaf95c9d5e3836d3926
      size: 684860
    - path: stages/data_split.py
      md5: 519fbe22a8ce712999f28010f3c56fe6
      size: 1606
    params:
      params.yaml:
        base:
          project: bank_customer_churn
          data_dir: data
          data_fname: Churn_Modelling.csv
          cat_cols:
          - Geography
          - Gender
          num_cols:
          - CreditScore
          - Age
          - Tenure
          - Balance
          - NumOfProducts
          - HasCrCard
          - IsActiveMember
          - EstimatedSalary
          targ_col: Exited
          random_state: 42
          model_dir: .mlem/model
          model_name: lightgbm-model
        data_split:
          test_size: 0.25
    outs:
    - path: data/X_test.pkl
      md5: ed4694a9b43123ef7fc1cc82d2324d63
      size: 191055
    - path: data/X_train.pkl
      md5: b67fd58d5da69337bebaaa43f9827c2b
      size: 571084
    - path: data/y_test.pkl
      md5: 7743d704b8b97cc303ceef12b9be6832
      size: 60613
    - path: data/y_train.pkl
      md5: c5e58ac55c3f8077ffac66b0e9b3536a
      size: 180622
  train:
    cmd: python stages/train.py --config=params.yaml
    deps:
    - path: data/X_train.pkl
      md5: b67fd58d5da69337bebaaa43f9827c2b
      size: 571084
    - path: data/y_train.pkl
      md5: c5e58ac55c3f8077ffac66b0e9b3536a
      size: 180622
    - path: stages/train.py
      md5: 0b54deca2ae4aef900a981ddcd4131fa
      size: 2578
    params:
      params.yaml:
        base:
          project: bank_customer_churn
          data_dir: data
          data_fname: Churn_Modelling.csv
          cat_cols:
          - Geography
          - Gender
          num_cols:
          - CreditScore
          - Age
          - Tenure
          - Balance
          - NumOfProducts
          - HasCrCard
          - IsActiveMember
          - EstimatedSalary
          targ_col: Exited
          random_state: 42
          model_dir: .mlem/model
          model_name: lightgbm-model
        train:
          model_type: lightgbm
          params:
            n_estimators: 100
            max_depth: 10
    outs:
    - path: .mlem/model/lightgbm-model
      md5: c530e789b2dbfdc0efeea42edb137f62
      size: 347074
    - path: .mlem/model/lightgbm-model.mlem
      md5: 45e84a88639465339677294d22e966e3
      size: 3526
  eval:
    cmd: python stages/eval.py --config=params.yaml
    deps:
    - path: .mlem/model/lightgbm-model
      md5: c530e789b2dbfdc0efeea42edb137f62
      size: 347074
    - path: .mlem/model/lightgbm-model.mlem
      md5: 45e84a88639465339677294d22e966e3
      size: 3526
    - path: data/X_test.pkl
      md5: ed4694a9b43123ef7fc1cc82d2324d63
      size: 191055
    - path: data/y_test.pkl
      md5: 7743d704b8b97cc303ceef12b9be6832
      size: 60613
    - path: stages/eval.py
      md5: 2daf87d8b5be40a9fb32a490c8559cbb
      size: 2571
    params:
      params.yaml:
        base:
          project: bank_customer_churn
          data_dir: data
          data_fname: Churn_Modelling.csv
          cat_cols:
          - Geography
          - Gender
          num_cols:
          - CreditScore
          - Age
          - Tenure
          - Balance
          - NumOfProducts
          - HasCrCard
          - IsActiveMember
          - EstimatedSalary
          targ_col: Exited
          random_state: 42
          model_dir: .mlem/model
          model_name: lightgbm-model
        data_split:
          test_size: 0.25
        train:
          model_type: lightgbm
          params:
            n_estimators: 100
            max_depth: 10
    outs:
    - path: eval_plots/cm.png
      md5: fb7c2da652e3b48bc2bbe2b29d062a76
      size: 10081
    - path: eval_plots/plots/roc.json
      md5: dff0e75aece787c4652b885d968fb82f
      size: 71495
    - path: feat_imp.csv
      md5: 35516dc52261994e9a430a72601f3c07
      size: 330
    - path: metrics.json
      md5: a5fb3333d14146ede3c7f04742dc4848
      size: 67
    - path: models/perm_imp.joblib
      md5: 2420a762d92426f5dd1c1d803a565149
      size: 348460
