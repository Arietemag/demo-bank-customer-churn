schema: '2.0'
stages:
  data_split:
    cmd: python stages/data_split.py --config=params.yaml
    deps:
    - path: data/Churn_Modelling.csv
      md5: 73fba4fd85b6dbaf95c9d5e3836d3926
      size: 684860
    - path: stages/data_split.py
      md5: 519fbe22a8ce712999f28010f3c56fe6
      size: 1606
    params:
      params.yaml:
        base:
          project: bank_customer_churn
          data_dir: data
          data_fname: Churn_Modelling.csv
          cat_cols:
          - Geography
          num_cols:
          - CreditScore
          - Age
          - Tenure
          - Balance
          - NumOfProducts
          - HasCrCard
          - IsActiveMember
          - EstimatedSalary
          targ_col: Exited
          random_state: 42
          model_dir: .mlem/model
        data_split:
          test_size: 0.2
    outs:
    - path: data/X_test.pkl
      md5: 8e3bb70a52b3a62e752479d0909b523f
      size: 149028
    - path: data/X_train.pkl
      md5: c18cf3cc97d2420e6ea9a800ee9f76bd
      size: 593049
    - path: data/y_test.pkl
      md5: 5cb7f308f5e494440cff950668b8854e
      size: 48613
    - path: data/y_train.pkl
      md5: 0769a9115abf2917c054f2aef18112ac
      size: 192622
  train:
    cmd: python stages/train.py --config=params.yaml
    deps:
    - path: data/X_train.pkl
      md5: c18cf3cc97d2420e6ea9a800ee9f76bd
      size: 593049
    - path: data/y_train.pkl
      md5: 0769a9115abf2917c054f2aef18112ac
      size: 192622
    - path: stages/train.py
      md5: 5b39947c77841799b2c970cd662dd6da
      size: 2428
    params:
      params.yaml:
        base:
          project: bank_customer_churn
          data_dir: data
          data_fname: Churn_Modelling.csv
          cat_cols:
          - Geography
          num_cols:
          - CreditScore
          - Age
          - Tenure
          - Balance
          - NumOfProducts
          - HasCrCard
          - IsActiveMember
          - EstimatedSalary
          targ_col: Exited
          random_state: 42
          model_dir: .mlem/model
        train:
          model_type: randomforest
          params:
            n_estimators: 150
            max_depth: 15
    outs:
    - path: .mlem/model/clf-model
      md5: 09dcd92d00a07962d2e9e09b283ff97a
      size: 17322587
    - path: .mlem/model/clf-model.mlem
      md5: 1e27593b88018fbef04d9c336d8ad003
      size: 3252
  eval:
    cmd: python stages/eval.py --config=params.yaml
    deps:
    - path: .mlem/model/clf-model
      md5: 09dcd92d00a07962d2e9e09b283ff97a
      size: 17322587
    - path: .mlem/model/clf-model.mlem
      md5: 1e27593b88018fbef04d9c336d8ad003
      size: 3252
    - path: data/X_test.pkl
      md5: 8e3bb70a52b3a62e752479d0909b523f
      size: 149028
    - path: data/y_test.pkl
      md5: 5cb7f308f5e494440cff950668b8854e
      size: 48613
    - path: stages/eval.py
      md5: 01cf10dab98aed930e7bc2eea7439b9d
      size: 2692
    params:
      params.yaml:
        base:
          project: bank_customer_churn
          data_dir: data
          data_fname: Churn_Modelling.csv
          cat_cols:
          - Geography
          num_cols:
          - CreditScore
          - Age
          - Tenure
          - Balance
          - NumOfProducts
          - HasCrCard
          - IsActiveMember
          - EstimatedSalary
          targ_col: Exited
          random_state: 42
          model_dir: .mlem/model
        data_split:
          test_size: 0.2
        train:
          model_type: randomforest
          params:
            n_estimators: 150
            max_depth: 15
    outs:
    - path: eval_plots/cm.png
      md5: e94f058a9f5f10d9804c9c16633040dc
      size: 10536
    - path: eval_plots/plots/roc.json
      md5: 4304f93a741e32b157349c808a7d6607
      size: 59876
    - path: feat_imp.csv
      md5: 6d60fea7749d9ce202f62d5efc19aae0
      size: 300
    - path: metrics.json
      md5: d65842e4995509e4f16f639008aa2472
      size: 65
    - path: models/perm_imp.joblib
      md5: 62a851421f0f632127f9aa919fa86f4b
      size: 17316012
