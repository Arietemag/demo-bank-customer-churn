schema: '2.0'
stages:
  data_split:
    cmd: python stages/data_split.py --config=params.yaml
    deps:
    - path: data/Churn_Modelling.csv
      md5: 73fba4fd85b6dbaf95c9d5e3836d3926
      size: 684860
    - path: stages/data_split.py
      md5: 519fbe22a8ce712999f28010f3c56fe6
      size: 1606
    params:
      params.yaml:
        base:
          project: bank_customer_churn
          data_dir: data
          data_fname: Churn_Modelling.csv
          cat_cols: []
          num_cols:
          - CreditScore
          - Age
          - Tenure
          - Balance
          - NumOfProducts
          - HasCrCard
          - IsActiveMember
          - EstimatedSalary
          targ_col: Exited
          random_state: 42
        data_split:
          test_size: 0.25
    outs:
    - path: data/X_test.pkl
      md5: 7fb8b7e58242a4e9933b960a4b0f3498
      size: 180939
    - path: data/X_train.pkl
      md5: 50604ccbc4e19805ef19229536310080
      size: 540948
    - path: data/y_test.pkl
      md5: 7743d704b8b97cc303ceef12b9be6832
      size: 60613
    - path: data/y_train.pkl
      md5: c5e58ac55c3f8077ffac66b0e9b3536a
      size: 180622
  train:
    cmd: python stages/train.py --config=params.yaml
    deps:
    - path: data/X_train.pkl
      md5: 50604ccbc4e19805ef19229536310080
      size: 540948
    - path: data/y_train.pkl
      md5: c5e58ac55c3f8077ffac66b0e9b3536a
      size: 180622
    - path: stages/train.py
      md5: 4d5305f35b6189e9031a4ccd459c3144
      size: 1404
    params:
      params.yaml:
        base:
          project: bank_customer_churn
          data_dir: data
          data_fname: Churn_Modelling.csv
          cat_cols: []
          num_cols:
          - CreditScore
          - Age
          - Tenure
          - Balance
          - NumOfProducts
          - HasCrCard
          - IsActiveMember
          - EstimatedSalary
          targ_col: Exited
          random_state: 42
        train:
          models_dir: models
          model_fname: model.joblib
          params:
            n_estimators: 50
            max_depth: 5
    outs:
    - path: models/model.joblib
      md5: 8aa1391f6b838a222109527672b5a439
      size: 198264
  eval:
    cmd: python stages/eval.py --config=params.yaml
    deps:
    - path: data/X_test.pkl
      md5: 7fb8b7e58242a4e9933b960a4b0f3498
      size: 180939
    - path: data/y_test.pkl
      md5: 7743d704b8b97cc303ceef12b9be6832
      size: 60613
    - path: models/model.joblib
      md5: 8aa1391f6b838a222109527672b5a439
      size: 198264
    - path: stages/eval.py
      md5: dfc00664510f2edf3d6e5bd2ad32da6b
      size: 1813
    params:
      params.yaml:
        base:
          project: bank_customer_churn
          data_dir: data
          data_fname: Churn_Modelling.csv
          cat_cols: []
          num_cols:
          - CreditScore
          - Age
          - Tenure
          - Balance
          - NumOfProducts
          - HasCrCard
          - IsActiveMember
          - EstimatedSalary
          targ_col: Exited
          random_state: 42
        data_split:
          test_size: 0.25
        train:
          models_dir: models
          model_fname: model.joblib
          params:
            n_estimators: 50
            max_depth: 5
    outs:
    - path: eval_plots/cm.png
      md5: ef8433b4ec6f38e5545137c93ecbe1fb
      size: 14193
    - path: eval_plots/plots/roc.json
      md5: 02f5323d541ae7e7a193cbb7cdb0d30f
      size: 96904
    - path: metrics.json
      md5: 320a766242babfb1ff0f9b80585a29c8
      size: 67
  run_notebook:
    cmd: papermill TrainChurnModel.ipynb TrainChurnModel_out.ipynb -p n_estimators
      30 -p max_depth 10 -p model_type lightgbm
    deps:
    - path: TrainChurnModel.ipynb
      md5: a70e139e23507d379682378afb632ff8
      size: 29263
    - path: data/Churn_Modelling.csv
      md5: 73fba4fd85b6dbaf95c9d5e3836d3926
      size: 684860
    params:
      params.yaml:
        base:
          project: bank_customer_churn
          data_dir: data
          data_fname: Churn_Modelling.csv
          cat_cols: []
          num_cols:
          - CreditScore
          - Age
          - Tenure
          - Balance
          - NumOfProducts
          - HasCrCard
          - IsActiveMember
          - EstimatedSalary
          targ_col: Exited
          random_state: 42
        data_split:
          test_size: 0.25
        train:
          models_dir: models
          model_fname: model.joblib
          model_type: lightgbm
          params:
            n_estimators: 30
            max_depth: 10
    outs:
    - path: eval_plots/cm.png
      md5: bd360d260c13b95a12bab95f575366de
      size: 7311
    - path: eval_plots/plots/roc.json
      md5: 5f8d586fd5f066f738199802f5c1d5a8
      size: 109282
    - path: metrics.json
      md5: b5e2cdf5cc9e5d1e3035801543dbfa48
      size: 66
    - path: models/model.joblib
      md5: 57dce9d16b87826a0a4b230dd1c8555f
      size: 105631
